<div class="library-container">
  <div class="header-section">
    <h1 class="title">–ú–æ—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞</h1>
    <p class="subtitle">–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —á–∏—Ç–∞—Ç—å –≤–∞—à–∏ –ª—é–±–∏–º—ã–µ –∫–Ω–∏–≥–∏</p>
  </div>
  
  <div class="search-container">
    <app-custom-text-input
      type="text"
      placeholder="–ü–æ–∏—Å–∫ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ..."
      [value]="searchTerm"
      (valueChange)="searchTerm = $event">
    </app-custom-text-input>
  </div>

  <div class="books-grid" *ngIf="!isLoading && libraryItems.length > 0">
    <div class="book-card card-hover" *ngFor="let item of libraryItems; let i = index">
      <div class="book-placeholder-container" (click)="navigateToBookContent(item.book_id)">
        <div class="book-placeholder">
          <div class="placeholder-icon">üìñ</div>
          <div class="placeholder-text">{{ (item.book?.title || 'Book').charAt(0) }}</div>
        </div>
        <div class="progress-overlay">
          <div class="progress-bar" [style.width.%]="getProgressPercentage(item)"></div>
        </div>
      </div>
      
      <div class="book-info">
        <h3 class="book-name" (click)="navigateToBookDetail(item.book_id)">{{ item.book?.title || '–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏' }}</h3>
        <p class="author-name">{{ item.book?.author || '–ê–≤—Ç–æ—Ä' }}</p>
        
        <div class="progress-info">
          <div class="progress-text">{{ getProgressText(item) }}</div>
          <div class="progress-circle">
            <svg class="progress-ring" width="40" height="40">
              <circle
                class="progress-ring-circle"
                stroke="#E0E0E0"
                stroke-width="3"
                fill="transparent"
                r="16"
                cx="20"
                cy="20"/>
              <circle
                class="progress-ring-progress"
                stroke="#282365"
                stroke-width="3"
                fill="transparent"
                r="16"
                cx="20"
                cy="20"
                [style.stroke-dasharray]="2 * 3.14159 * 16"
                [style.stroke-dashoffset]="2 * 3.14159 * 16 * (1 - getProgressPercentage(item) / 100)"
                transform="rotate(-90 20 20)"/>
            </svg>
            <span class="progress-percent">{{ getProgressPercentage(item) }}%</span>
          </div>
        </div>
        
        <div class="book-actions">
          <button class="action-btn continue-btn" (click)="navigateToBookContent(item.book_id)">
            <span>üìñ</span>
            <span>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</span>
          </button>
          <button class="action-btn details-btn" (click)="navigateToBookDetail(item.book_id)">
            <span>‚ÑπÔ∏è</span>
            <span>–î–µ—Ç–∞–ª–∏</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="loading" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏...</p>
  </div>

  <div class="empty-state" *ngIf="!isLoading && libraryItems.length === 0">
    <div class="empty-icon">üìö</div>
    <h2>–í–∞—à–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—É—Å—Ç–∞</h2>
    <p>–ù–∞—á–Ω–∏—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∫–Ω–∏–≥–∏ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞!</p>
    <button class="browse-btn" (click)="navigateToBooks()">
      –ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–Ω–∏–≥–∞–º
    </button>
  </div>
</div>

