<div class="library-container">
  <div class="header-section">
    <h1 class="title">My Library</h1>
    <p class="subtitle">Keep reading your favorite books</p>
  </div>
  
  <div class="search-container">
    <app-custom-text-input
      type="text"
      placeholder="Search in library..."
      [value]="searchTerm"
      (valueChange)="searchTerm = $event">
    </app-custom-text-input>
  </div>

  <div class="books-grid" *ngIf="!isLoading && libraryItems.length > 0">
    <div class="book-card card-hover" *ngFor="let item of libraryItems; let i = index">
      <div class="book-placeholder-container" (click)="navigateToBookContent(item.book_id)">
        <div class="book-placeholder">
          <div class="placeholder-icon">üìñ</div>
          <div class="placeholder-text">{{ (item.book?.title || 'Book').charAt(0) }}</div>
        </div>
        <div class="progress-overlay">
          <div class="progress-bar" [style.width.%]="getProgressPercentage(item)"></div>
        </div>
      </div>
      
      <div class="book-info">
        <h3 class="book-name" (click)="navigateToBookDetail(item.book_id)">{{ item.book?.title || 'Book title' }}</h3>
        <p class="author-name">{{ item.book?.author || 'Author' }}</p>
        
        <div class="progress-info">
          <div class="progress-text">{{ getProgressText(item) }}</div>
          <div class="progress-circle">
            <svg class="progress-ring" width="40" height="40">
              <circle
                class="progress-ring-circle"
                stroke="#E0E0E0"
                stroke-width="3"
                fill="transparent"
                r="16"
                cx="20"
                cy="20"/>
              <circle
                class="progress-ring-progress"
                stroke="#282365"
                stroke-width="3"
                fill="transparent"
                r="16"
                cx="20"
                cy="20"
                [style.stroke-dasharray]="2 * 3.14159 * 16"
                [style.stroke-dashoffset]="2 * 3.14159 * 16 * (1 - getProgressPercentage(item) / 100)"
                transform="rotate(-90 20 20)"/>
            </svg>
            <span class="progress-percent">{{ getProgressPercentage(item) }}%</span>
          </div>
        </div>
        
        <div class="book-actions">
          <button class="action-btn continue-btn" (click)="navigateToBookContent(item.book_id)">
            <span>üìñ</span>
            <span>Continue</span>
          </button>
          <button class="action-btn details-btn" (click)="navigateToBookDetail(item.book_id)">
            <span>‚ÑπÔ∏è</span>
            <span>Details</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="loading" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Loading library...</p>
  </div>

  <div class="empty-state" *ngIf="!isLoading && libraryItems.length === 0">
    <div class="empty-icon">üìö</div>
    <h2>Your library is empty</h2>
    <p>Start adding books from the catalog!</p>
    <button class="browse-btn" (click)="navigateToBooks()">
      Go to books
    </button>
  </div>
</div>

